---
layout: post
title: "Blue Team Security Lab Project – SIEM & Threat Detection"
categories:
- Blue Team
- Security
- SIEM
tags:
- Wazuh
- pfSense
- Snort
- Security Monitoring
- Threat Detection
date: 2025-09-16
description: A hands-on lab project integrating Wazuh, pfSense, Snort, Ubuntu, Windows 10, Apache, and VirusTotal for security monitoring, threat detection, and SIEM operations.
image: assets/img/projects/Wazuh/post.png
---

## Blue Team Security Lab Project – SIEM & Threat Detection

I developed a comprehensive **Blue Team security lab project** using **GNS3**, **VirtualBox**, and multiple endpoints, integrating real-time monitoring and threat detection. This lab demonstrates how various security components can work together to detect threats effectively.

### Architecture Overview

The lab architecture is shown below:

![Security Lab Architecture](assets/img/projects/Wazuh/architect.png)  
*Architecture showing pfSense firewall, Wazuh server, endpoints, Apache, and VirusTotal integration.*

- **pfSense Firewall & IDS/IPS (Snort):** Network perimeter, monitoring traffic and forwarding logs to Wazuh.  
- **Wazuh Server:** Central SIEM collecting logs from Windows, Ubuntu, Apache, and pfSense.  
- **Endpoints:**
  - **Windows 10 & Ubuntu Machines:** Running Wazuh agents for process, file, and system monitoring.  
  - **Apache Server:** Monitored for SQL injection, Shellshock, and web-based malicious activity.  
- **Routers & Network:** Cisco routers in GNS3 simulate network topology.  
- **VirusTotal Integration:** Configured to automatically analyze suspicious files and URLs (no screenshot available).  

### Key Detection Capabilities & Screenshots

- **SSH Brute Force Detection** – Alerts and configuration:  

![SSH Brute Force Alert](assets/img/projects/Wazuh/brute_force_alert.png)  
*Wazuh dashboard showing repeated failed login attempts.*

- **Critical File Changes & Malicious Commands Detection** – Alerts for `/etc/passwd`, `/etc/shadow` modifications and suspicious commands:  

![File & Command Alerts](assets/img/projects/Wazuh/audited.png)  
*Wazuh dashboard displaying malicious commands and file changes.*

- **File & Directory Monitoring (FIM)** – Detects add, remove, and modification in specific directories:  

![FIM Alerts](assets/img/projects/Wazuh/FIM.png)  
*Wazuh alerts showing monitored file/directory changes.*

- **Shellshock Exploit Detection** – Configured and monitored:  

![Shellshock Detection](assets/img/projects/Wazuh/shellshook.png)  
*Apache logs showing attempted Shellshock exploit.*

- **Hidden Processes Detection** – Configured in Wazuh 

![Hidden Processes Detection Config](assets/img/projects/Wazuh/Detecting_hidden_processes.png)  

- **SQL Injection Detection** – Alerts captured from Apache logs:  

![SQL Injection Detection](assets/img/projects/Wazuh/apache-sql-injection.png)  
*Apache logs showing attempted SQL injection attacks.*

- **Vulnerability Detection (CVE)** – Monitors installed software for known vulnerabilities:  

![Vulnerability Detection](assets/img/projects/Wazuh/wazuh-cve.png)  
*Wazuh alerts showing CVEs detected on Ubuntu/Windows endpoints.*

- **VirusTotal Integration** – Configured to automatically analyze suspicious files and URLs:  

![VirusTotal Configuration](assets/img/projects/Wazuh/virustotal-config.png)  
*Screenshot showing VirusTotal integration setup in Wazuh.*


---

### Why This Project Is Valuable

This lab allowed me to **simulate a real enterprise security environment**, integrating multiple security tools to detect threats effectively. By combining **network monitoring, endpoint security, log aggregation, and threat intelligence**, I gained hands-on experience in:

- Threat detection  
- Log correlation across endpoints and network devices  
- Building realistic security monitoring and alerting workflows  

The screenshots illustrate **real-time alerts and detected events**, demonstrating the effectiveness of an integrated SIEM solution in a controlled environment.
